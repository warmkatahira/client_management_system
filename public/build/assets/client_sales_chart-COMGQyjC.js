import{C as m}from"./chartjs-plugin-datalabels.esm-CglBOSix.js";import{c as _}from"./chart_color-DSS5FTIa.js";$(document).ready(function(){f()});function f(){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/client_detail/ajax_get_chart_data",type:"GET",data:{client_id:$("#client_id").val()},dataType:"json",success:function(n){try{const r=document.getElementById("client_sales_chart_div");r.innerHTML="",$.each(n.last_year_client_sales,function(o,l){const i=l[0].base_name,t=document.createElement("canvas");t.id="client_sales_chart_"+o,t.classList.add("w-full","p-2","bg-white","rounded-2xl","shadow-md","col-span-6"),t.height=300,r.appendChild(t);const u=Array.from({length:12},(a,s)=>s+1+"月"),d=C(n,o,i),h=t.getContext("2d");new m(h,{type:"line",data:{labels:u,datasets:d},options:{responsive:!1,scales:{"y-axis-1":{type:"linear",position:"left",ticks:{max:1e8,min:0,stepSize:1e6}}},plugins:{legend:{labels:{usePointStyle:!0}},tooltip:{callbacks:{title:function(a){return a[0].dataset.yearMonthJp[a[0].dataIndex]},label:function(a){return a.formattedValue+"円"}},bodyFont:{size:14},titleFont:{size:16},padding:12,boxPadding:6}}}})})}catch{alert("グラフの生成に失敗しました。")}},error:function(){alert("グラフの生成に失敗しました。")}})}function C(e,n,r){const o=_[0],l=_[1];let i=[],t=[],u=[],d=[];const h=e.current_year_client_sales.length===0?"":e.current_year_client_sales[n][0].year_month.split("-")[0];$.each(e.current_year_client_sales,function(s,p){parseInt(s)===parseInt(n)&&$.each(p,function(y,c){i.push(c.amount),u.push(c.year_month_jp)})});const a=e.last_year_client_sales.length===0?"":e.last_year_client_sales[n][0].year_month.split("-")[0];return $.each(e.last_year_client_sales,function(s,p){parseInt(s)===parseInt(n)&&$.each(p,function(y,c){t.push(c.amount),d.push(c.year_month_jp)})}),[{type:"line",label:"売上推移（"+r+`@${h}年）`,data:i,borderColor:o.borderColor,backgroundColor:o.backgroundColor,pointBackgroundColor:o.borderColor,pointRadius:5,pointHoverRadius:7,yAxisID:"y-axis-1",yearMonthJp:u},{type:"line",label:"売上推移（"+r+`@${a}年）`,data:t,borderColor:l.borderColor,backgroundColor:l.backgroundColor,pointBackgroundColor:l.borderColor,pointRadius:5,pointHoverRadius:7,borderDash:[5,5],yAxisID:"y-axis-1",yearMonthJp:d}]}
