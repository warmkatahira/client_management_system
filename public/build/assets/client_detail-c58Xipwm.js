import{C as u}from"./chartjs-plugin-datalabels.esm-CglBOSix.js";$(document).ready(function(){p()});function p(){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:"/client_detail/ajax_get_chart_data",type:"GET",data:{client_id:$("#client_id").val()},dataType:"json",success:function(n){try{const t=document.getElementById("client_sales_chart_div");t.innerHTML="",$.each(n.client_sales,function(a,s){const l=s[0].base_name,e=document.createElement("canvas");e.id="client_sales_chart_"+a,e.classList.add("w-full","p-2","bg-white","rounded-2xl","shadow-md"),e.height=300,t.appendChild(e);const o=s.map(r=>r.year_month_jp),c=_(n.client_sales,a,l),d=e.getContext("2d");new u(d,{type:"line",data:{labels:o,datasets:c},options:{responsive:!1,scales:{"y-axis-1":{type:"linear",position:"left",ticks:{max:1e8,min:0,stepSize:1e6}}},plugins:{legend:{labels:{usePointStyle:!0}},tooltip:{callbacks:{label:function(r){return r.formattedValue+"円"}}}}}})})}catch{alert("グラフの生成に失敗しました。")}},error:function(){alert("グラフの生成に失敗しました。")}})}function _(i,n,t){let a=[];return $.each(i,function(s,l){parseInt(s)===parseInt(n)&&$.each(l,function(e,o){a.push(o.amount)})}),[{type:"line",label:"売上推移("+t+")",data:a,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)",pointBackgroundColor:"rgb(75, 192, 192)",pointRadius:5,pointHoverRadius:7,yAxisID:"y-axis-1",borderRadius:30}]}
