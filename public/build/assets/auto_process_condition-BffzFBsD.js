import{s as p}from"./loading-ChqFcCVw.js";function l(){const o=$(".condition_div").length;$(".condition_div").each(function(t){$(this).find("p.text-base").text("条件"+(t+1));let e=$(this).find(".delete_condition_btn");e.length===0&&($(this).find("div.flex.justify-between").append('<button type="button" class="delete_condition_btn bg-red-500 text-white px-2 py-1 rounded text-xs">削除</button>'),e=$(this).find(".delete_condition_btn")),o===1?e.hide():e.show()})}$("#add_condition_btn").on("click",function(){const t=$(".condition_div").last().clone();t.find("select, input").val(""),t.find(".bg-gray-300").removeClass("bg-gray-300"),t.find(":disabled").prop("disabled",!1),$("#conditions_wrapper").append(t),l()});$("#conditions_wrapper").on("click",".delete_condition_btn",function(){$(this).closest(".condition_div").remove(),l()});l();$("#conditions_wrapper").on("change",".column_name",function(){const o=$(this).val(),t=$(this).closest(".condition_div"),e=t.find(".value_text_wrapper"),a=t.find(".value_delivery_company_wrapper"),i=e.find("input"),n=a.find("select");o==="shipping_method_id"?(e.hide(),a.removeClass("hidden").show(),i.prop("disabled",!0),n.prop("disabled",!1),i.prop("name","value_dummy[]"),n.prop("name","value[]")):(e.show(),a.hide(),i.prop("disabled",!1),n.prop("disabled",!0),i.prop("name","value[]"),n.prop("name","value_dummy[]"))});$(".column_name").trigger("change");$("#auto_process_condition_update_enter").on("click",function(){const o="/auto_process_condition_update/ajax_validation",t=u();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:o,type:"GET",data:t,dataType:"json",success:function(e){window.confirm("自動処理条件の設定を実行しますか？")===!0&&(p(),$("#auto_process_condition_update_form").submit())},error:function(e){if(e.status===422){const a=e.responseJSON.errors;let i="";$.each(a,function(n,s){const d=n.match(/\.(\d+)$/),c=parseInt(d[1],10)+1;i+=`条件${c}: ${s[0]}
`}),alert(i)}else alert("通信エラーが発生しました。")}})});function u(){return{auto_process_id:$("#auto_process_id").val(),column_name:$("select[name='column_name[]']").map(function(){return $(this).val()}).get(),value:$("input[name='value[]'], select[name='value[]']").map(function(){return $(this).val()}).get(),operator:$("select[name='operator[]']").map(function(){return $(this).val()}).get()}}$("#conditions_wrapper").on("change",".operator",function(){r($(this))});function r(o){const t=o.val(),e=o.closest(".condition_div"),a=e.find(".value_text_wrapper"),i=e.find(".value_delivery_company_wrapper"),n=a.find("input"),s=i.find("select");t==="is null"||t==="is not null"?(n.val(null),s.val(null),n.val(null).prop("readonly",!0).addClass("bg-gray-300"),s.val(null).css("pointer-events","none").addClass("bg-gray-300")):(n.prop("readonly",!1).removeClass("bg-gray-300"),s.css("pointer-events","").removeClass("bg-gray-300"))}$(".operator").each(function(){r($(this))});
